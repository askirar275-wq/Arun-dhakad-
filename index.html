<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ChatApp with Firebase Login</title>
<style>
/* ----------- Common Reset ----------- */
body{margin:0;padding:0;font-family:Arial,sans-serif;background:#ece5dd;display:flex;justify-content:center;align-items:center;height:100vh;transition:background 0.3s;}
body.dark{background:#121212;color:#eee;}
.app{width:100%;max-width:400px;height:90vh;background:#fff;border-radius:15px;overflow:hidden;box-shadow:0 0 10px rgba(0,0,0,0.3);display:flex;flex-direction:column;transition:background 0.3s;}
body.dark .app{background:#1f1f1f;}

/* ----------- Login Screen ----------- */
#loginScreen{flex:1;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:20px;}
#loginScreen h2{margin-bottom:20px;}
#phoneInput,#otpInput{padding:10px;margin:10px;width:80%;border-radius:10px;border:1px solid #ccc;font-size:16px;}
button{padding:10px 20px;margin:5px;border:none;border-radius:10px;background:#075E54;color:#fff;cursor:pointer;font-size:16px;}
button:hover{background:#0a7b6c;}
#recaptcha-container{margin-top:15px;}

/* ----------- Chat List ----------- */
.chat-list{flex:1;overflow-y:auto;position:relative;}
.chat-item{display:flex;align-items:center;padding:10px;border-bottom:1px solid #ddd;cursor:pointer;position:relative;}
.chat-item img{width:45px;height:45px;border-radius:50%;margin-right:10px;}
.chat-info{flex:1;display:flex;flex-direction:column;}
.chat-info .name{font-weight:bold;}
.chat-info .last-msg{font-size:13px;color:#555;}
.chat-time{font-size:12px;color:#999;}
.unread-dot{width:12px;height:12px;background:red;border-radius:50%;position:absolute;top:15px;right:10px;display:none;}

/* ----------- Chat Screen ----------- */
.chat-screen{flex:1;display:none;flex-direction:column;}
.header{background:#075E54;color:#fff;padding:10px;display:flex;align-items:center;justify-content:space-between;}
.header-left{display:flex;align-items:center;gap:10px;}
.back-btn{font-size:20px;cursor:pointer;}
.header img{width:40px;height:40px;border-radius:50%;border:2px solid #fff;}
.info{display:flex;flex-direction:column;}
.info .name{font-size:16px;font-weight:bold;}
.info .status{font-size:12px;display:flex;align-items:center;gap:5px;}
.dot{width:10px;height:10px;border-radius:50%;display:inline-block;}
.settings-btn{font-size:20px;cursor:pointer;}
.messages{flex:1;padding:10px;background:#ece5dd;overflow-y:auto;scroll-behavior:smooth;}
.msg-wrapper{display:flex;flex-direction:column;align-items:flex-end;margin:5px 0;}
.received-wrapper{align-items:flex-start;}
.msg{max-width:70%;padding:8px 12px;border-radius:10px;font-size:14px;background:#cce5ff;}
.received .msg{background:#fff;border:1px solid #ddd;}
.status-text{font-size:11px;color:#555;margin-top:2px;}
.input-area{display:flex;padding:10px;background:#f0f0f0;}
.input-area input{flex:1;padding:10px;border:none;border-radius:20px;outline:none;font-size:14px;}
.input-area button{margin-left:10px;padding:10px 15px;border:none;border-radius:50%;background:#075E54;color:#fff;font-size:16px;cursor:pointer;}
</style>
</head>
<body>
<div class="app">

  <!-- Login Screen -->
  <div id="loginScreen">
    <h2>üì± Mobile Login</h2>
    <input type="text" id="phoneInput" placeholder="+91XXXXXXXXXX">
    <div id="recaptcha-container"></div>
    <button onclick="sendOTP()">Send OTP</button>
    <input type="text" id="otpInput" placeholder="Enter OTP">
    <button onclick="verifyOTP()">Verify OTP</button>
  </div>

  <!-- Chat Screen -->
  <div id="chatApp" style="display:none;flex:1;flex-direction:column;">
    <div class="chat-list" id="chatList">
      <div class="chat-item" data-name="Rahul Sharma" data-dp="https://i.pravatar.cc/150?img=5" onclick="openChat('Rahul Sharma','https://i.pravatar.cc/150?img=5')">
        <img src="https://i.pravatar.cc/150?img=5">
        <div class="chat-info">
          <div class="name">Rahul Sharma</div>
          <div class="last-msg">Hey! ‡§ï‡•à‡§∏‡•á ‡§π‡•ã?</div>
        </div>
        <div class="chat-time">10:30 AM</div>
        <div class="unread-dot"></div>
      </div>
    </div>

    <div class="chat-screen" id="chatScreen">
      <div class="header">
        <div class="header-left">
          <span class="back-btn" onclick="goBack()">‚Üê</span>
          <img id="chatDP" src="">
          <div class="info">
            <div class="name" id="chatName"></div>
            <div class="status" id="userStatus">
              <span class="dot" id="statusDot" style="background:gray;"></span>
              <span id="statusText">Offline</span>
            </div>
          </div>
        </div>
        <div class="settings-btn" onclick="openSettings()">‚öôÔ∏è</div>
      </div>

      <div class="messages" id="chatBox"></div>

      <div class="input-area">
        <input type="text" id="msgInput" placeholder="‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§≤‡§ø‡§ñ‡•á‡§Ç...">
        <button onclick="sendMsg()">‚û§</button>
      </div>
    </div>
  </div>
</div>

<!-- Firebase Scripts -->
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
<script>
// üî• Firebase Config (‡§Ö‡§™‡§®‡§æ details ‡§≠‡§∞‡•ã)
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  projectId: "YOUR_PROJECT_ID",
  storageBucket: "YOUR_PROJECT.appspot.com",
  messagingSenderId: "YOUR_SENDER_ID",
  appId: "YOUR_APP_ID"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
let confirmationResult;

// OTP ‡§≠‡•á‡§ú‡§®‡§æ
function sendOTP(){
  let phone = document.getElementById("phoneInput").value;
  window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier('recaptcha-container', {'size':'invisible'});
  auth.signInWithPhoneNumber(phone, window.recaptchaVerifier)
    .then((result)=>{
      confirmationResult = result;
      alert("OTP Sent!");
    }).catch((e)=>alert(e.message));
}

// OTP Verify
function verifyOTP(){
  let code = document.getElementById("otpInput").value;
  confirmationResult.confirm(code).then((result)=>{
    document.getElementById("loginScreen").style.display="none";
    document.getElementById("chatApp").style.display="flex";
  }).catch((e)=>alert("Invalid OTP"));
}

// ---------------- Chat Functions ----------------
function getTime12hr(){
  let now=new Date();
  let hours=now.getHours();
  let minutes=now.getMinutes().toString().padStart(2,"0");
  let ampm=hours>=12?"PM":"AM";
  hours=hours%12; hours=hours?hours:12;
  return hours+":"+minutes+" "+ampm;
}
function openChat(name,dp){
  document.getElementById("chatList").style.display="none";
  document.getElementById("chatScreen").style.display="flex";
  document.getElementById("chatName").innerText=name;
  document.getElementById("chatDP").src=dp;
  document.getElementById('chatBox').innerHTML='';
}
function goBack(){
  document.getElementById("chatScreen").style.display="none";
  document.getElementById("chatList").style.display="block";
}
function sendMsg(){
  let input=document.getElementById("msgInput");
  let text=input.value.trim();
  if(text!==""){
    let chatBox=document.getElementById("chatBox");
    let wrapper=document.createElement("div");
    wrapper.classList.add("msg-wrapper");
    let msg=document.createElement("div");
    msg.classList.add("msg");
    msg.innerText=text;
    wrapper.appendChild(msg);
    let time=document.createElement("div");
    time.classList.add("status-text");
    time.innerText=getTime12hr();
    wrapper.appendChild(time);
    chatBox.appendChild(wrapper);
    chatBox.scrollTop=chatBox.scrollHeight;
    input.value="";
  }
}
function openSettings(){alert("Settings Coming Soon...");}
</script>
</body>
</html>
