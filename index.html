<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Galaxy Shooter — Image Player</title>

<style>
  :root{--ac:#7ef9ff;--ac2:#b388ff;--glass:rgba(255,255,255,0.06);}
  *{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
  html,body{margin:0;padding:0;height:100%;background:#000;font-family:Inter,Arial;color:#eafcff;overflow:hidden}
  #gameBox{position:relative;width:100vw;height:100vh;background:#000;overflow:hidden;}
  canvas{width:100%;height:100%;}
  .hud{position:absolute;top:10px;left:10px;display:flex;gap:10px;z-index:20}
  .chip{padding:8px 12px;border-radius:10px;background:var(--glass);border:2px solid rgba(255,255,255,0.1);font-weight:700}
  .controls{position:absolute;top:10px;right:10px;display:flex;gap:10px;z-index:20}
  .btn{padding:8px 12px;border-radius:12px;border:2px solid var(--ac);background:transparent;color:var(--ac);font-weight:700;cursor:pointer;transition:.1s}
  .btn:active{transform:scale(.9);background:rgba(255,255,255,0.05)}
  .btn2{border-color:var(--ac2);color:var(--ac2)}
  /* Mobile controls */
  .mControls{position:absolute;bottom:12px;left:12px;right:12px;display:flex;justify-content:space-between;z-index:30;pointer-events:none}
  .circle{width:62px;height:62px;border:2px solid rgba(255,255,255,0.12);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:28px;color:white;pointer-events:auto;transition:.1s}
  .circle:active{background:rgba(255,255,255,0.05);transform:scale(.9)}
  .fireBtn{width:70px;height:70px;border-radius:14px;border:2px solid var(--ac);background:transparent;pointer-events:auto;font-weight:800;color:var(--ac)}
  /* Overlay */
  #overlay{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.6);z-index:50}
  .menu{background:rgba(255,255,255,0.05);backdrop-filter:blur(10px);padding:20px;border-radius:14px;width:85%;max-width:420px;text-align:center;border:2px solid rgba(255,255,255,0.08)}
  h2{margin-top:0}
</style>
</head>

<body>

<div id="gameBox">
  <canvas id="game"></canvas>

  <div class="hud">
    <div class="chip" id="scoreUI">Score: 0</div>
    <div class="chip" id="killsUI">Kills: 0</div>
    <div class="chip" id="powerUI">Bullet: 1</div>
  </div>

  <div class="controls">
    <button class="btn" id="autoBtn">Auto: OFF</button>
    <button class="btn" id="pauseBtn">Pause</button>
    <button class="btn2 btn" id="resetBtn">Reset</button>
  </div>

  <div class="mControls">
      <div style="display:flex;gap:10px">
        <div class="circle" id="leftBtn">◀</div>
        <div class="circle" id="rightBtn">▶</div>
      </div>
      <button class="fireBtn" id="fireBtn">FIRE</button>
  </div>

  <div id="overlay">
    <div class="menu">
      <h2>Galaxy Shooter</h2>
      <p>Swipe anywhere to move. Auto fire available. Kill 50 enemies to spawn the boss. Pick up “+” to upgrade bullets.</p>
      <button class="btn" id="startBtn">Start Game</button>
    </div>
  </div>

</div>


<script>
// Canvas setup
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
function resize(){
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resize();
window.onresize = resize;

// Load player image
const playerImg = new Image();
playerImg.src = "images/player.png";   // <== USE THIS IMAGE
let playerReady = false;
playerImg.onload = ()=> playerReady = true;

// Game state
let running = false, paused = false, autoFire = false;
let score = 0, kills = 0;
let bullets = [], enemies = [], pickups = [], particles = [];
let boss = null, bossSpawned = false;

// Player
let player = {
  x: canvas.width/2 - 40,
  y: canvas.height - 160,
  w: 80,
  h: 80,
  speed: 7,
  bulletPower: 1,
  cooldown: 0,
  fireRate: 230,
  alive: true,
  tx: null, ty: null
};

// UI
const scoreUI = document.getElementById("scoreUI");
const killsUI = document.getElementById("killsUI");
const powerUI = document.getElementById("powerUI");
const overlay = document.getElementById("overlay");

// Shoot
function shoot(){
  if(!player.alive) return;
  const now = performance.now();
  if(now - player.cooldown < player.fireRate) return;
  player.cooldown = now;

  const size = 10 + player.bulletPower * 3;
  bullets.push({x: player.x + player.w/2, y: player.y, w:size, h:size*1.6, vy:-12, dmg:player.bulletPower});
}

// Auto fire
let autoTimer = null;
function setupAuto(){
  if(autoTimer) clearInterval(autoTimer);
  if(autoFire){
    autoTimer = setInterval(()=> shoot(), player.fireRate*0.9);
  }
}

// Spawn enemy
function spawnEnemy(){
  enemies.push({
    x: Math.random() * (canvas.width - 50),
    y: -60,
    w:50, h:50,
    vy:1.2 + Math.random()*1.3,
    hp: 1
  });
}

// Spawn boss
function spawnBoss(){
  boss = {
    x: canvas.width/2 - 160,
    y: -200,
    w:320,
    h:160,
    hp:120,
    maxHp:120,
    vy:1,
    timer:0
  };
  bossSpawned = true;
}

// Pointer = swipe movement
let pointerDown = false;
function ptr(e){
  const r = canvas.getBoundingClientRect();
  let X = e.clientX || e.touches?.[0]?.clientX;
  let Y = e.clientY || e.touches?.[0]?.clientY;
  player.tx = X - r.left - player.w/2;
  player.ty = Y - r.top - player.h/2;
}
canvas.addEventListener("pointerdown", e=> {pointerDown=true;ptr(e);});
canvas.addEventListener("pointerup", ()=> pointerDown=false);
canvas.addEventListener("pointermove", e=> {if(pointerDown)ptr(e);});
canvas.addEventListener("touchmove", e=> {ptr(e);});

// Mobile left/right buttons
document.getElementById("leftBtn").onpointerdown=()=> player.tx = player.x - 100;
document.getElementById("rightBtn").onpointerdown=()=> player.tx = player.x + 100;
window.onpointerup=()=>{};

// Main Loop
function loop(){
  if(!running || paused){ requestAnimationFrame(loop); return; }

  // Background
  ctx.fillStyle = "#000015";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // Player movement
  if(player.tx!=null){
    player.x += (player.tx - player.x) * 0.20;
    player.y += (player.ty - player.y) * 0.20;
  }

  player.x = Math.max(0, Math.min(canvas.width-player.w, player.x));
  player.y = Math.max(0, Math.min(canvas.height-player.h, player.y));

  // Draw player image
  if(playerReady){
    ctx.drawImage(playerImg, player.x, player.y, player.w, player.h);
  }

  // Bullets
  for(let i=bullets.length-1;i>=0;i--){
    const b = bullets[i];
    b.y += b.vy;
    ctx.fillStyle="#9ff";
    ctx.fillRect(b.x-4, b.y, b.w, b.h);
    if(b.y < -50){ bullets.splice(i,1); }
  }

  // Spawn enemies
  if(Math.random()<0.03) spawnEnemy();

  // Enemies update
  for(let i=enemies.length-1;i>=0;i--){
    const e = enemies[i];
    e.y += e.vy;

    ctx.fillStyle="#ff7f7f";
    ctx.fillRect(e.x,e.y,e.w,e.h);

    // Hit detection
    for(let bi=bullets.length-1;bi>=0;bi--){
      const b=bullets[bi];
      if(b.x > e.x && b.x < e.x+e.w && b.y < e.y+e.h){
        e.hp -= b.dmg;
        bullets.splice(bi,1);
        if(e.hp<=0){
          kills++; score++;
          enemies.splice(i,1);
        }
        break;
      }
    }
  }

  // Boss spawn check
  if(kills>=50 && !bossSpawned){
    spawnBoss();
  }

  // Boss draw/update
  if(boss){
    boss.y += boss.vy;
    ctx.fillStyle="#ffaa55";
    ctx.fillRect(boss.x,boss.y,boss.w,boss.h);

    let hpPerc = boss.hp/boss.maxHp;
    ctx.fillStyle="red";
    ctx.fillRect(boss.x, boss.y-12, boss.w*hpPerc, 8);

    // Boss hit
    for(let bi=bullets.length-1;bi>=0;bi--){
      const b = bullets[bi];
      if(b.x > boss.x && b.x < boss.x+boss.w && b.y < boss.y+boss.h){
        boss.hp -= b.dmg;
        bullets.splice(bi,1);
        if(boss.hp<=0){
          boss=null; bossSpawned=false; kills=0;
        }
      }
    }
  }

  // Update UI
  scoreUI.textContent = "Score: "+score;
  killsUI.textContent = "Kills: "+kills;
  powerUI.textContent = "Bullet: "+player.bulletPower;

  requestAnimationFrame(loop);
}

// Buttons
document.getElementById("startBtn").onclick = ()=>{
  overlay.style.display="none";
  running = true;
  requestAnimationFrame(loop);
};
document.getElementById("resetBtn").onclick = ()=> location.reload();
document.getElementById("pauseBtn").onclick = ()=>{
  paused = !paused;
  pauseBtn.textContent = paused ? "Resume" : "Pause";
};
document.getElementById("autoBtn").onclick = ()=>{
  autoFire = !autoFire;
  autoBtn.textContent = "Auto: "+(autoFire?"ON":"OFF");
  setupAuto();
};
document.getElementById("fireBtn").onclick = ()=> shoot();

// Unlock audio
document.addEventListener("touchstart",()=>{ if(!audioCtx) audioCtx=new AudioContext(); },{once:true});

</script>

</body>
</html>
